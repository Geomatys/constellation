<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:a4j="http://richfaces.org/a4j"
                xmlns:mf="http://mapfaces.org/taglib">

    <!-- ensure providerBean is loaded -->
    <h:outputText value="#{providerBean}" style="display:none;"/>
    
    <h:outputText value="#{bean.i18n['newsource']}" />
    <span/>
    <h:inputText value="#{bean.newSourceName}" />
    <span/>
    <h:commandButton action="#{bean.createSource}" value="#{bean.i18n['add']}" />
    <br/>
    <br/>

    <div class="rounded">
        <mf:Outline id="storePreview" rootVisible="false" value="#{bean.instanceModel}" var="node" width="100%"
                    rowStyler="#{bean.instanceRowStyler}">

            <mf:DataTableColumn>
               <h:commandLink action="#{node.select}">
                    <h:outputText value="#{node.userObject.id}"/>
                </h:commandLink>
            </mf:DataTableColumn>

            <mf:DataTableColumn width="24px">
                 <a4j:commandLink action="#{node.config}">
                    <h:graphicImage value="provider.edit.png.mfRes" style="border:none;"/>
                </a4j:commandLink>
            </mf:DataTableColumn>
            
            <mf:DataTableColumn width="24px">
                <a4j:commandLink action="#{node.reload}" reRender="storePreview">
                    <h:graphicImage value="provider.reload.png.mfRes" style="border:none;"/>
                </a4j:commandLink>
            </mf:DataTableColumn>

            <mf:DataTableColumn width="24px">
                <a4j:commandLink action="#{node.delete}" reRender="storePreview">
                    <h:graphicImage value="provider.remove.png.mfRes" style="border:none;"/>
                </a4j:commandLink>
            </mf:DataTableColumn>

        </mf:Outline>
    </div>
    
    <mf:Div styleClass="rounded" rendered="#{bean.configuredInstance != null}">
        <mf:Outline id="layerPreview" rootVisible="false" value="#{bean.layerModel}" var="node" width="100%"
                    rowStyler="#{mf:constant('org.constellation.bean.HighLightRowStyler.INSTANCE')}">

            <mf:DataTableColumn width="24px">
                <h:graphicImage value="#{node.statusIcon}" style="border:none;"/>
            </mf:DataTableColumn>
            
            <mf:DataTableColumn>
                    <h:outputText value="#{node.userObject}"/>
            </mf:DataTableColumn>

            <mf:DataTableColumn width="24px">
                <a4j:commandLink action="#{node.config}">
                    <h:graphicImage value="provider.edit.png.mfRes" style="border:none;"/>
                </a4j:commandLink>
            </mf:DataTableColumn>
            
            <!--
            <mf:DataTableColumn width="24px">
                <mf:switch>
                    <mf:case condition="#{mf:isInstance(node,'org.constellation.menu.provider.AbstractDataStoreServiceBean$TypeNode') and node.exist}" fallthrought="false">
                        <a4j:commandLink action="#{node.show}" 
                                         oncomplete="window.open('#{contextPath}/provider/mapview.jsf','maptab',config='height=600, width=800, toolbar=no, menubar=no, scrollbars=yes, resizable=yes, location=no, directories=no, status=yes');">
                            <h:graphicImage value="provider.view.png.mfRes" style="border:none;"/>
                        </a4j:commandLink>
                    </mf:case>
                </mf:switch>
            </mf:DataTableColumn>
            -->
            
            <mf:DataTableColumn width="24px">
                <mf:switch>
                    <mf:case condition="#{mf:isInstance(node,'org.constellation.menu.provider.AbstractDataStoreServiceBean$TypeNode') and not node.exist}" fallthrought="false">
                        <a4j:commandLink action="#{node.delete}" reRender="layerPreview">
                            <h:graphicImage value="provider.remove.png.mfRes" style="border:none;"/>
                        </a4j:commandLink>
                    </mf:case>
                </mf:switch>
            </mf:DataTableColumn>
            
            
        </mf:Outline>
    </mf:Div>
    

</ui:composition>

