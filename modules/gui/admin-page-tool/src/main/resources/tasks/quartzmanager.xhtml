<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:c="http://java.sun.com/jstl/core"
                xmlns:a4j="http://richfaces.org/a4j"
                xmlns:mf="http://mapfaces.org/taglib"
                template="/pages/base.xhtml">

    <ui:param name="pageTitle" value="#{taskmanagerBean.i18n['quartzscheduler']}"/>

    <ui:define name="content">
       
        <h:outputText value="#{taskmanagerBean.i18n['newtask']}" />
        <span/>
        <h:commandButton action="#{taskmanagerBean.createTask}" value="#{taskmanagerBean.i18n['add']}" />
        <br/>
        <br/>
        
        <!-- tasks list -->
        <div class="rounded">
            
            <mf:Outline id="sourceLayers" actionVisible="false" rootVisible="false"
                value="#{taskmanagerBean.taskModel}" var="node" width="100%" 
                rowStyler="#{mf:constant('org.constellation.bean.HighLightRowStyler.INSTANCE')}">
                
                <!-- Name column -->
                <mf:DataTableColumn>
                    #{node.userObject.properties['title']}
                </mf:DataTableColumn>
                
                <!-- Last date run column -->
                <mf:DataTableColumn>
                    #{node.userObject.properties['lastRun']}
                </mf:DataTableColumn>
                
                <!-- Last status column -->
                <mf:DataTableColumn>
                    #{node.userObject.properties['lastError']}
                </mf:DataTableColumn>
                                                
                <!-- Edit action column -->
                <mf:DataTableColumn width="16px">
                    <a4j:commandLink action="#{node.edit}" reRender="sourceLayers">
                        <img src="#{facesContext.externalContext.requestContextPath}/provider.edit.png.mfRes" style="border:none;"/>
                    </a4j:commandLink>
                </mf:DataTableColumn>
                                
                <!-- Delete action column -->
                <mf:DataTableColumn width="30px">
                    <a4j:commandLink action="#{node.delete}" reRender="sourceLayers">
                        <img src="#{facesContext.externalContext.requestContextPath}/provider.remove.png.mfRes" style="border:none;"/>
                    </a4j:commandLink>
                </mf:DataTableColumn>

            </mf:Outline>
            
        </div>
        
    </ui:define>

</ui:composition>
